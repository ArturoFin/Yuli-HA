<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1.0" />
  <title>Para Yuli - Mi Graduación</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --petal-1:#FFD700;
      --petal-2:#FFA500;
      --stem:#3d521c;
      --stem-dark:#2a3a12;
      --center-1:#6d4c41;
      --center-2:#2b1c18;

      --night-top:#05070a;
      --night-mid:#141e30;
      --night-bot:#1b2735;

      --glass-bg: rgba(255,255,255,.90);
      --glass-border: rgba(255,255,255,.55);
      --shadow: 0 20px 50px rgba(0,0,0,.55);

      --text:#2c3e50;
      --ease: cubic-bezier(.23,1,.32,1);
    }

    *{box-sizing:border-box;margin:0;padding:0}
    body{
      font-family:'Lato',sans-serif;
      height:100vh;
      overflow:hidden;
      display:flex;
      align-items:center;
      justify-content:center;
      background: linear-gradient(to bottom, var(--night-top) 0%, var(--night-mid) 60%, var(--night-bot) 100%);
      color:#fff;
      perspective: 1200px;
    }

    /* Cielo */
    .sky-elements{
      position:absolute; inset:0 0 auto 0;
      height:60%;
      pointer-events:none;
      z-index:0;
      transform: translateZ(-200px);
    }
    .moon{
      position:absolute;
      top:10%;
      right:12%;
      width:84px;height:84px;border-radius:50%;
      background: radial-gradient(circle at 30% 30%, #ffffff 0%, #ffeebb 55%, rgba(255,238,187,.6) 100%);
      box-shadow: 0 0 45px rgba(255,255,255,.35);
      opacity:.85;
      filter: blur(.2px);
    }
    .star{
      position:absolute;
      width:2px;height:2px;border-radius:50%;
      background:white;
      opacity:.8;
      animation: twinkle 3.2s infinite ease-in-out alternate;
    }
    @keyframes twinkle{
      0%{opacity:.25; transform: scale(.8)}
      100%{opacity:1; transform: scale(1.3)}
    }

    /* Luciérnagas */
    .fireflies{
      position:absolute; inset:0;
      pointer-events:none;
      z-index:1;
    }
    .firefly{
      position:absolute;
      width:4px;height:4px;border-radius:50%;
      background:#ffffe0;
      box-shadow: 0 0 10px #ffffe0, 0 0 20px #ffd700;
      opacity:0;
      animation: fly 14s linear infinite;
      will-change: transform, opacity;
    }
    @keyframes fly{
      0%{transform: translate(0,0); opacity:0}
      10%{opacity:1}
      90%{opacity:1}
      100%{transform: translate(140px,-160px); opacity:0}
    }

    /* Campo con perspectiva real */
    .field-wrap{
      position:absolute;
      left:0; right:0;
      bottom:-40px;
      height:70%;
      z-index:2;
      pointer-events:none;

      transform-style: preserve-3d;
      perspective: 900px;
    }

    .field{
      position:absolute; inset:0;
      transform-style: preserve-3d;
      /* inclinación del “suelo” para que parezca campo */
      transform: rotateX(58deg) translateY(120px);
      transform-origin: bottom center;
      will-change: transform;
    }

    /* --- Girasol (pieza base) --- */
    .sunflower{
      position:absolute;
      transform-style: preserve-3d;
      transform-origin: bottom center;
      will-change: transform;
    }

    .stem{
      position:absolute;
      left:50%;
      bottom:0;
      width:10px;
      height:180px;
      transform: translateX(-50%);
      background: linear-gradient(90deg, var(--stem-dark), var(--stem), var(--stem-dark));
      border-radius: 8px;
      box-shadow: inset 0 0 10px rgba(0,0,0,.25);
    }

    .leaf{
      position:absolute;
      width:74px; height:34px;
      background: radial-gradient(circle at 30% 40%, #4f6a27 0%, #2f3f16 70%);
      border-radius: 0 60% 0 60%;
      opacity:.95;
      filter: drop-shadow(0 4px 6px rgba(0,0,0,.35));
    }
    .leaf.l1{ left:50%; bottom:55px; transform: translateX(-5px) rotate(-20deg) skewX(-10deg); }
    .leaf.l2{ left:50%; bottom:95px; transform: translateX(-65px) rotate(165deg) skewX(8deg); opacity:.9; }

    .head{
      position:absolute;
      left:50%;
      bottom:150px;
      width:120px;height:120px;
      transform: translateX(-50%);
      transform-style: preserve-3d;
      filter: drop-shadow(0 12px 14px rgba(0,0,0,.45));
    }

    /* Pétalos: spans rotados */
    .petals{
      position:absolute; inset:0;
    }
    .petals span{
      position:absolute;
      left:50%;
      top:50%;
      width:46px;
      height:18px;
      transform-origin: 10% 50%;
      border-radius: 18px 80px 80px 18px;
      background: linear-gradient(180deg, var(--petal-1), var(--petal-2));
      box-shadow: inset 0 -2px 0 rgba(0,0,0,.15);
      filter: saturate(1.05);
    }

    .center{
      position:absolute;
      left:50%; top:50%;
      width:46px; height:46px;
      transform: translate(-50%,-50%) translateZ(8px);
      border-radius:50%;
      background:
        radial-gradient(circle at 35% 35%, #8d6e63 0%, var(--center-1) 35%, var(--center-2) 100%);
      box-shadow: inset 0 0 18px rgba(0,0,0,.65);
    }
    .center::after{
      content:"";
      position:absolute; inset:0;
      border-radius:50%;
      background-image: radial-gradient(circle, rgba(255,255,255,.12) 1px, transparent 1px);
      background-size: 5px 5px;
      opacity:.35;
      mix-blend-mode: overlay;
    }

    /* Animación de “viento” */
    @keyframes swayStem{
      0%{ transform: translateX(-50%) rotateZ(-1.2deg) }
      100%{ transform: translateX(-50%) rotateZ(1.2deg) }
    }
    @keyframes swayHead{
      0%{ transform: translateX(-50%) rotateZ(2deg) translateZ(10px) }
      100%{ transform: translateX(-50%) rotateZ(-2deg) translateZ(10px) }
    }

    /* Tarjeta */
    .card-container{
      position:relative;
      z-index:10;
      width:90%;
      max-width:720px;
      transform-style:preserve-3d;
      will-change: transform;
    }
    .letter-card{
      background: var(--glass-bg);
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(20px);
      -webkit-backdrop-filter: blur(20px);
      border-radius: 24px;
      padding: 40px;
      box-shadow: var(--shadow);
      min-height: 520px;
      overflow:hidden;
      transform: translateZ(60px);
    }

    .header{
      text-align:center;
      margin-bottom:26px;
      padding-bottom:14px;
      border-bottom: 2px solid rgba(139,69,19,.10);
    }
    .header h1{
      font-family:'Playfair Display',serif;
      font-size:2rem;
      color:#5D4037;
      text-shadow:0 2px 4px rgba(0,0,0,.10);
      margin-bottom:4px;
    }
    .header span{
      font-size:.9rem;
      color:var(--stem);
      letter-spacing:3px;
      text-transform:uppercase;
      font-weight:700;
    }

    .message-area{
      display:flex;
      align-items:center;
      justify-content:center;
      text-align:center;
      padding: 14px 0;
      min-height: 260px;
      position:relative;
    }
    .message-text{
      font-family:'Playfair Display',serif;
      font-size:1.4rem;
      line-height:1.7;
      color:var(--text);
      transition: opacity .45s ease, transform .45s ease;
      font-weight:500;
    }
    .message-text.hidden{
      opacity:0;
      transform: translateY(10px);
      position:absolute;
    }

    .controls{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:14px;
      margin-top: 18px;
      padding-top: 18px;
      border-top: 1px solid rgba(0,0,0,.06);
    }
    .nav-btn{
      background: var(--stem);
      color:#fff;
      border:none;
      padding: 12px 22px;
      border-radius: 999px;
      cursor:pointer;
      font-weight:700;
      transition: transform .35s var(--ease), background .35s var(--ease), box-shadow .35s var(--ease), color .35s var(--ease);
      display:flex;
      align-items:center;
      gap:8px;
      box-shadow: 0 6px 18px rgba(61,82,28,.28);
    }
    .nav-btn:hover{
      background: var(--petal-2);
      color:#222;
      transform: translateY(-2px);
      box-shadow: 0 10px 22px rgba(255,165,0,.35);
    }
    .nav-btn:disabled{
      background:#dcdcdc;
      color:#777;
      cursor:not-allowed;
      box-shadow:none;
      transform:none;
    }

    .progress-container{
      width: 210px;
      height: 6px;
      background:#e0e0e0;
      border-radius: 999px;
      overflow:hidden;
    }
    .progress-bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--stem), var(--petal-2));
      transition: width .45s ease;
    }
    .page-indicator{
      font-size:.8rem;
      color:#666;
      font-weight:700;
      margin-bottom:8px;
    }

    /* Responsive */
    @media (max-width: 600px){
      .letter-card{ padding: 24px; min-height: 500px; }
      .header h1{ font-size: 1.55rem; }
      .message-text{ font-size: 1.15rem; }
      .progress-container{ width: 160px; }
      .field-wrap{ height: 62%; bottom:-60px; } /* baja el campo en móvil */
    }
  </style>
</head>

<body>
  <!-- Cielo -->
  <div class="sky-elements" id="skyElements">
    <div class="moon"></div>
  </div>

  <!-- Luciérnagas -->
  <div class="fireflies" id="fireflies"></div>

  <!-- Campo -->
  <div class="field-wrap" id="fieldWrap">
    <div class="field" id="field"></div>
  </div>

  <!-- Tarjeta -->
  <main class="card-container" id="cardContainer">
    <article class="letter-card">
      <header class="header">
        <h1>Hola, Yuli</h1>
        <span>Mi Graduación</span>
      </header>

      <section class="message-area" id="messageArea">
        <p class="message-text">Cargando mensaje...</p>
      </section>

      <footer class="controls">
        <button class="nav-btn" id="prevBtn" onclick="prevFragment()">
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
          </svg>
          Anterior
        </button>

        <div style="text-align:center">
          <div class="page-indicator" id="pageIndicator">1 / 1</div>
          <div class="progress-container">
            <div class="progress-bar" id="progressBar"></div>
          </div>
        </div>

        <button class="nav-btn" id="nextBtn" onclick="nextFragment()">
          Siguiente
          <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
          </svg>
        </button>
      </footer>
    </article>
  </main>

  <script>
    /* --- Mensajes --- */
    const messageFragments = [
      "Hola Yuli, ayer fue mi graduación y esto es complicado de decir, pero te quería entregarte esto en cuanto llegases a aquí.",
      "Es algo que me hubiese gustado verte junto con el vestido en la ceremonia de la graduación, porque de hecho lo compré para ti solo solo lo imagino jaja.",
      "Tal vez no sea la gran cosa, pero con el vestido claro que te veías genial.",
      "Sin embargo, por azar de la vida, estuviste con trabajo.",
      "Recibe por favor esto, que refleja lo importante que fuiste en toda mi vida universitaria.",
      "Me agradó conocerte en esta etapa de inocencia (no tanto pero xd). Para ser sincero, aprendí mucho.",
      "Espero que con el mismo profesionalismo, pronto sea tu turno de vestirte de graduada.",
      "Y no me refiero a una toga o un diploma, sino al hecho de que ya dejas de ser universitaria para ejercer la verdadera ingeniería.",
      "Haré cambios mi amiga, eso ya es un hecho para q ser bueno si puedo ser malo.",
      "Hoy será mi último día que escriba algo sentimental como este.",
      "De hecho, ya dejaré esa vida del cordialísimo. Entendí que no me sirvió para nada.",
      "Me toca ser un ingeniero rígido y para tomar decisiones frías."
    ];

    let currentIndex = 0;
    const total = messageFragments.length;

    const messageArea = document.getElementById("messageArea");
    const prevBtn = document.getElementById("prevBtn");
    const nextBtn = document.getElementById("nextBtn");
    const progressBar = document.getElementById("progressBar");
    const pageIndicator = document.getElementById("pageIndicator");

    const cardContainer = document.getElementById("cardContainer");
    const skyElements = document.getElementById("skyElements");
    const fireflies = document.getElementById("fireflies");

    const fieldWrap = document.getElementById("fieldWrap");
    const field = document.getElementById("field");

    function renderText() {
      const currentText = document.querySelector(".message-text");
      if (currentText) {
        currentText.classList.add("hidden");
        setTimeout(() => {
          messageArea.innerHTML = "";
          const p = document.createElement("p");
          p.className = "message-text";
          p.textContent = messageFragments[currentIndex];
          messageArea.appendChild(p);
          void p.offsetWidth;
        }, 450);
      } else {
        const p = document.createElement("p");
        p.className = "message-text";
        p.textContent = messageFragments[currentIndex];
        messageArea.innerHTML = "";
        messageArea.appendChild(p);
      }

      prevBtn.disabled = currentIndex === 0;
      if (currentIndex === total - 1) {
        nextBtn.innerHTML = 'Finalizar <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path></svg>';
      } else {
        nextBtn.innerHTML = 'Siguiente <svg width="18" height="18" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path></svg>';
      }

      const progress = ((currentIndex + 1) / total) * 100;
      progressBar.style.width = `${progress}%`;
      pageIndicator.textContent = `${currentIndex + 1} / ${total}`;
    }

    function nextFragment() {
      if (currentIndex < total - 1) {
        currentIndex++;
        renderText();
      } else {
        nextBtn.disabled = true;
      }
    }
    function prevFragment() {
      if (currentIndex > 0) {
        currentIndex--;
        nextBtn.disabled = false;
        renderText();
      }
    }

    /* --- Cielo y luciérnagas --- */
    function createStars() {
      const starCount = 70;
      for (let i = 0; i < starCount; i++) {
        const s = document.createElement("div");
        s.className = "star";
        s.style.left = Math.random() * 100 + "%";
        s.style.top = Math.random() * 78 + "%";
        const size = 1 + Math.random() * 2.2;
        s.style.width = size + "px";
        s.style.height = size + "px";
        s.style.animationDelay = (Math.random() * 3) + "s";
        s.style.opacity = (0.35 + Math.random() * 0.65).toFixed(2);
        skyElements.appendChild(s);
      }
    }

    function createFireflies() {
      const count = window.innerWidth < 600 ? 10 : 18;
      for (let i = 0; i < count; i++) {
        const f = document.createElement("div");
        f.className = "firefly";
        f.style.left = Math.random() * 100 + "%";
        f.style.top = (55 + Math.random() * 45) + "%";
        f.style.animationDelay = (Math.random() * 10) + "s";
        f.style.animationDuration = (11 + Math.random() * 10) + "s";
        fireflies.appendChild(f);
      }
    }

    /* --- Girasoles: construcción realista con pétalos --- */
    function buildPetals(petalsEl, count) {
      const frag = document.createDocumentFragment();
      for (let i = 0; i < count; i++) {
        const petal = document.createElement("span");
        const angle = (360 / count) * i + (Math.random() * 4 - 2);

        // distancia desde el centro (un poco variada)
        const radius = 44 + Math.random() * 6;

        // tamaño del pétalo (varía)
        const w = 40 + Math.random() * 18;
        const h = 14 + Math.random() * 8;
        petal.style.width = w + "px";
        petal.style.height = h + "px";

        // Colocación: centrado + rotación + empuje radial
        petal.style.transform =
          `translate(-50%,-50%) rotate(${angle}deg) translateX(${radius}px)`;

        // Variar “tono” muy leve
        const sat = 1 + Math.random() * 0.08;
        petal.style.filter = `saturate(${sat})`;

        frag.appendChild(petal);
      }
      petalsEl.appendChild(frag);
    }

    function createSunflower({ xPct, yPct, z, scale, blur, opacity, wind, headSize }) {
      const flower = document.createElement("div");
      flower.className = "sunflower";

      // Posición sobre el plano del campo
      flower.style.left = xPct + "%";
      flower.style.bottom = yPct + "%";

      // Profundidad real
      flower.style.transform = `translateZ(${z}px) scale(${scale})`;
      flower.style.filter = `blur(${blur}px)`;
      flower.style.opacity = opacity;

      // Estructura
      const stem = document.createElement("div");
      stem.className = "stem";
      stem.style.height = (150 + Math.random() * 120) + "px";
      stem.style.animation = `swayStem ${wind}s ease-in-out infinite alternate`;

      const l1 = document.createElement("div");
      l1.className = "leaf l1";
      const l2 = document.createElement("div");
      l2.className = "leaf l2";

      const head = document.createElement("div");
      head.className = "head";
      head.style.width = headSize + "px";
      head.style.height = headSize + "px";
      head.style.bottom = (parseFloat(stem.style.height) - 35) + "px";
      head.style.animation = `swayHead ${wind * 0.9}s ease-in-out infinite alternate`;

      const petals = document.createElement("div");
      petals.className = "petals";
      buildPetals(petals, 24);

      const center = document.createElement("div");
      center.className = "center";

      head.appendChild(petals);
      head.appendChild(center);

      flower.appendChild(stem);
      flower.appendChild(l1);
      flower.appendChild(l2);
      flower.appendChild(head);

      return flower;
    }

    function createField() {
      field.innerHTML = "";
      const frag = document.createDocumentFragment();

      // Ajuste: en móvil menos flores
      const mobile = window.innerWidth < 600;

      // Capas: (lejos) -> (medio) -> (cerca)
      // OJO: valores de z negativos “se van al fondo” en el 3D
      const layers = [
        { count: mobile ? 10 : 16, z: -220, scaleMin: 0.45, scaleMax: 0.70, blur: 1.8, opacity: 0.55, head: [70, 90] },
        { count: mobile ? 12 : 18, z: -120, scaleMin: 0.70, scaleMax: 1.05, blur: 1.0, opacity: 0.75, head: [86, 112] },
        { count: mobile ? 10 : 14, z: -30,  scaleMin: 1.05, scaleMax: 1.60, blur: 0.0, opacity: 0.92, head: [105, 140] }
      ];

      for (const layer of layers) {
        for (let i = 0; i < layer.count; i++) {
          // Distribución: lejos más centrado, cerca más a bordes
          let xPct;
          if (layer.scaleMax < 0.8) {
            xPct = 18 + Math.random() * 64;
          } else if (layer.scaleMax < 1.2) {
            xPct = 10 + Math.random() * 80;
          } else {
            xPct = (Math.random() > 0.5) ? (Math.random() * 22) : (78 + Math.random() * 22);
          }

          // yPct: mantenerlos “abajo” para no tapar tarjeta
          const yPct = 0 + Math.random() * 30;

          const scale = layer.scaleMin + Math.random() * (layer.scaleMax - layer.scaleMin);
          const wind = 2.6 + Math.random() * 2.8;
          const headSize = layer.head[0] + Math.random() * (layer.head[1] - layer.head[0]);

          const flower = createSunflower({
            xPct,
            yPct,
            z: layer.z + (Math.random() * 40 - 20),
            scale,
            blur: layer.blur,
            opacity: layer.opacity,
            wind,
            headSize
          });

          frag.appendChild(flower);
        }
      }

      field.appendChild(frag);
    }

    /* --- Parallax 3D (tarjeta vs fondo) --- */
    function handleMouseMove(e) {
      const x = (window.innerWidth / 2 - e.pageX) / 30;
      const y = (window.innerHeight / 2 - e.pageY) / 30;

      cardContainer.style.transform = `rotateY(${x}deg) rotateX(${y}deg)`;

      // Mover el campo (muy suave) para sensación de profundidad
      fieldWrap.style.transform = `translateX(${-x * 1.6}px) translateY(${-y * 1.2}px)`;

      skyElements.style.transform = `translateX(${-x * 0.5}px) translateY(${-y * 0.4}px)`;
    }
    function resetEffects() {
      cardContainer.style.transform = `rotateY(0deg) rotateX(0deg)`;
      fieldWrap.style.transform = `translate(0,0)`;
      skyElements.style.transform = `translate(0,0)`;
    }

    /* Teclado */
    document.addEventListener("keydown", (e) => {
      if (e.key === "ArrowRight") nextFragment();
      if (e.key === "ArrowLeft") prevFragment();
    });

    /* Re-render del campo en resize (para recolocar y ajustar cantidad) */
    let resizeTimer;
    window.addEventListener("resize", () => {
      clearTimeout(resizeTimer);
      resizeTimer = setTimeout(() => {
        createField();
      }, 200);
    });

    window.addEventListener("load", () => {
      createStars();
      createFireflies();
      createField();
      renderText();

      if (window.matchMedia("(hover: hover)").matches) {
        document.addEventListener("mousemove", handleMouseMove);
        document.addEventListener("mouseleave", resetEffects);
      }
    });
  </script>
</body>
</html>

